<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Heladería - Menú de Productos</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        html, body {
            overflow-x: hidden;
            width: 100%;
            max-width: 100vw;
        }
        
        body {
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            background: linear-gradient(135deg, #f8f4f0 0%, #f0e6d2 100%);
            color: #2c3e50;
            line-height: 1.6;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            min-height: 100vh;
            box-shadow: 0 0 30px rgba(0,0,0,0.1);
        }
        
        /* Header mejorado */
        .header {
            background: linear-gradient(135deg, #d4a574 0%, #c19653 50%, #a67c00 100%);
            padding: 25px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: repeating-linear-gradient(
                45deg,
                transparent,
                transparent 10px,
                rgba(255,255,255,0.05) 10px,
                rgba(255,255,255,0.05) 20px
            );
            pointer-events: none;
        }
        
        .header h1 {
            font-size: 3rem;
            color: white;
            font-weight: 700;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            position: relative;
            z-index: 1;
        }
        
        .header .subtitle {
            color: rgba(255,255,255,0.9);
            font-size: 1.2rem;
            font-style: italic;
            position: relative;
            z-index: 1;
        }
        
        /* Navegación mejorada */
        .nav-tabs {
            background: linear-gradient(135deg, #34495e 0%, #2c3e50 100%);
            border-bottom: 3px solid #c19653;
            padding: 0;
            margin: 0;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .nav-tabs ul {
            list-style: none;
            display: flex;
            margin: 0;
            padding: 0;
            justify-content: center;
        }
        
        .nav-tabs li {
            margin: 0 2px;
        }
        
        .nav-tabs a {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 15px 25px;
            text-decoration: none;
            color: rgba(255,255,255,0.8);
            background: transparent;
            border-radius: 8px 8px 0 0;
            font-size: 1rem;
            font-weight: 500;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .nav-tabs a:hover {
            background: rgba(255,255,255,0.1);
            color: white;
            transform: translateY(-2px);
        }
        
        .nav-tabs a.active {
            background: white;
            color: #c19653;
            font-weight: 600;
            box-shadow: 0 -3px 10px rgba(0,0,0,0.1);
        }
        
        .nav-tabs a.active::after {
            content: '';
            position: absolute;
            bottom: -3px;
            left: 0;
            right: 0;
            height: 3px;
            background: #c19653;
        }
        
        .content {
            padding: 30px;
        }
        
        /* Panel de filtros avanzado */
        .filters-panel {
            background: linear-gradient(135deg, #fff 0%, #f8f9fa 100%);
            border: 2px solid #e9ecef;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.08);
        }
        
        .filters-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e9ecef;
        }
        
        .filters-title {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.3rem;
            font-weight: 600;
            color: #2c3e50;
        }
        
        .filters-toggle {
            background: #c19653;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }
        
        .filters-toggle:hover {
            background: #a67c00;
            transform: scale(1.05);
        }
        
        .filters-content {
            display: grid;
            grid-template-columns: 1fr auto;
            gap: 20px;
            align-items: end;
        }
        
        .filters-content-productos {
            display: grid;
            grid-template-columns: 1fr auto auto;
            gap: 20px;
            align-items: end;
        }
        
        .search-section {
            position: relative;
        }
        
        .search-input {
            width: 100%;
            padding: 12px 45px 12px 15px;
            border: 2px solid #dee2e6;
            border-radius: 25px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: white;
        }
        
        .search-input:focus {
            outline: none;
            border-color: #c19653;
            box-shadow: 0 0 0 3px rgba(193, 150, 83, 0.1);
            transform: translateY(-2px);
        }
        
        .search-icon {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #6c757d;
            font-size: 1.2rem;
            pointer-events: none;
        }
        
        .filter-dropdown {
            position: relative;
            min-width: 200px;
        }
        
        .dropdown-select {
            width: 100%;
            padding: 12px 40px 12px 15px;
            border: 2px solid #dee2e6;
            border-radius: 25px;
            background: white;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            appearance: none;
        }
        
        .dropdown-select:focus {
            outline: none;
            border-color: #c19653;
            box-shadow: 0 0 0 3px rgba(193, 150, 83, 0.1);
        }
        
        .dropdown-icon {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #6c757d;
            pointer-events: none;
        }
        
        .filter-actions {
            display: flex;
            gap: 10px;
        }
        
        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            font-size: 1rem;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
            white-space: nowrap;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #c19653, #a67c00);
            color: white;
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #6c757d, #5a6268);
            color: white;
        }
        
        .btn-outline {
            background: transparent;
            border: 2px solid #c19653;
            color: #c19653;
        }
        
        .btn-outline:hover {
            background: #c19653;
            color: white;
        }
        
        /* Estadísticas de filtros */
        .filter-stats {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .stats-info {
            display: flex;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .stat-item {
            display: flex;
            align-items: center;
            gap: 5px;
            color: #6c757d;
            font-size: 0.9rem;
        }
        
        .active-filters {
            display: flex;
            align-items: center;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .filter-tag {
            background: #c19653;
            color: white;
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 0.8rem;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .filter-tag .remove {
            cursor: pointer;
            font-weight: bold;
            padding: 0 2px;
        }
        
        .filter-tag .remove:hover {
            background: rgba(255,255,255,0.2);
            border-radius: 50%;
        }
        
        /* Vista Categorías mejorada */
        .categorias-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }
        
        .categoria-card {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 15px;
            overflow: hidden;
            transition: all 0.3s ease;
            cursor: pointer;
            box-shadow: 0 5px 20px rgba(0,0,0,0.08);
            position: relative;
        }
        
        .categoria-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #c19653, #d4a574);
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }
        
        .categoria-card:hover {
            border-color: #c19653;
            box-shadow: 0 10px 30px rgba(193, 150, 83, 0.2);
            transform: translateY(-5px);
        }
        
        .categoria-card:hover::before {
            transform: scaleX(1);
        }
        
        .categoria-header {
            padding: 20px;
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
        }
        
        .categoria-icon {
            font-size: 3rem;
            margin-bottom: 10px;
            display: block;
        }
        
        .categoria-nombre {
            font-size: 1.4rem;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 5px;
        }
        
        .categoria-descripcion {
            color: #6c757d;
            font-size: 0.9rem;
        }
        
        .categoria-footer {
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: white;
        }
        
        .categoria-count {
            background: #c19653;
            color: white;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.9rem;
            font-weight: 600;
        }
        
        .categoria-arrow {
            color: #c19653;
            font-size: 1.2rem;
            transition: transform 0.3s ease;
        }
        
        .categoria-card:hover .categoria-arrow {
            transform: translateX(5px);
        }
        
        /* Vista Productos mejorada */
        .productos-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }
        
        .producto-card {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 15px;
            overflow: hidden;
            transition: all 0.3s ease;
            cursor: pointer;
            box-shadow: 0 5px 20px rgba(0,0,0,0.08);
            position: relative;
        }
        
        .producto-card:hover {
            border-color: #c19653;
            box-shadow: 0 10px 30px rgba(193, 150, 83, 0.2);
            transform: translateY(-5px);
        }
        
        .producto-card-imagen {
            width: 100%;
            height: 200px;
            position: relative;
            overflow: hidden;
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
        }
        
        .producto-card-imagen img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s ease;
        }
        
        .producto-card:hover .producto-card-imagen img {
            transform: scale(1.05);
        }
        
        .producto-card-placeholder {
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #d4a574, #c19653);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 4rem;
            color: white;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }
        
        .producto-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(193, 150, 83, 0.9);
            color: white;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: 600;
            backdrop-filter: blur(10px);
        }
        
        .producto-card-body {
            padding: 20px;
        }
        
        .producto-card-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 10px;
            line-height: 1.3;
        }
        
        .producto-card-descripcion {
            color: #6c757d;
            font-size: 0.95rem;
            margin-bottom: 15px;
            line-height: 1.5;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        .producto-card-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-top: 15px;
            border-top: 2px solid #f8f9fa;
        }
        
        .producto-card-precio {
            color: #28a745;
            font-weight: 700;
            font-size: 1.5rem;
        }
        
        .producto-card-categoria {
            background: #f8f9fa;
            color: #6c757d;
            padding: 6px 12px;
            font-size: 0.85rem;
            border-radius: 15px;
            border: 1px solid #e9ecef;
        }
        
        .breadcrumb {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border: 2px solid #e9ecef;
            padding: 15px 20px;
            margin-bottom: 25px;
            font-size: 1rem;
            border-radius: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .breadcrumb a {
            color: #c19653;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s ease;
        }
        
        .breadcrumb a:hover {
            color: #a67c00;
            text-decoration: underline;
        }
        
        .breadcrumb-separator {
            color: #6c757d;
            font-weight: bold;
        }
        
        .loading {
            text-align: center;
            padding: 60px;
            color: #6c757d;
            font-style: italic;
            font-size: 1.2rem;
        }
        
        .loading i {
            font-size: 2rem;
            margin-bottom: 15px;
            display: block;
            animation: spin 2s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .no-results {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border: 2px dashed #dee2e6;
            padding: 60px;
            text-align: center;
            color: #6c757d;
            margin: 30px 0;
            border-radius: 15px;
            grid-column: 1 / -1;
        }
        
        .no-results i {
            font-size: 3rem;
            margin-bottom: 15px;
            display: block;
            color: #c19653;
        }
        
        .error {
            background: linear-gradient(135deg, #f8d7da, #f5c6cb);
            border: 2px solid #f5c6cb;
            color: #721c24;
            padding: 20px;
            margin: 30px 0;
            border-radius: 15px;
            text-align: center;
        }
        
        /* Modal mejorado */
        .modal {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.6);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 20px;
            backdrop-filter: blur(5px);
        }
        
        .modal-content {
            background: white;
            border-radius: 20px;
            max-width: 600px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            animation: modalSlideIn 0.3s ease-out;
        }
        
        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: scale(0.9) translateY(-50px);
            }
            to {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }
        
        .modal-header {
            background: linear-gradient(135deg, #c19653, #a67c00);
            color: white;
            padding: 20px;
            border-radius: 20px 20px 0 0;
            font-weight: 600;
            font-size: 1.2rem;
        }
        
        .modal-body {
            padding: 30px;
        }
        
        .modal-close {
            position: absolute;
            top: 10px;
            right: 15px;
            background: none;
            border: none;
            font-size: 1.8rem;
            cursor: pointer;
            color: rgba(255,255,255,0.8);
            padding: 5px;
            border-radius: 50%;
            transition: all 0.3s ease;
        }
        
        .modal-close:hover {
            color: white;
            background: rgba(255,255,255,0.1);
        }
        
        .modal-image {
            width: 100%;
            max-width: 250px;
            height: 250px;
            object-fit: cover;
            border-radius: 15px;
            border: 3px solid #e9ecef;
            float: right;
            margin-left: 20px;
            margin-bottom: 20px;
        }
        
        .modal-placeholder {
            width: 100%;
            max-width: 250px;
            height: 250px;
            background: linear-gradient(135deg, #d4a574, #c19653);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 5rem;
            color: white;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
            float: right;
            margin-left: 20px;
            margin-bottom: 20px;
            border-radius: 15px;
            border: 3px solid #e9ecef;
        }
        
        /* Responsive optimizado para móvil */
        @media (max-width: 1024px) {
            .filters-content,
            .filters-content-productos {
                display: flex;
                flex-direction: column;
                gap: 15px;
                width: 100%;
            }
            
            .filter-dropdown {
                min-width: auto;
                width: 100%;
            }
            
            .filter-actions {
                justify-content: center;
                width: 100%;
            }
            
            .categorias-grid {
                grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
                gap: 20px;
            }
            
            .productos-grid {
                grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
                gap: 20px;
            }
        }
        
        @media (max-width: 768px) {
            * {
                box-sizing: border-box;
            }
            
            body {
                overflow-x: hidden;
                width: 100vw;
                max-width: 100%;
            }
            
            .container {
                margin: 0;
                box-shadow: none;
                width: 100vw;
                max-width: 100%;
                overflow-x: hidden;
            }
            
            .header {
                padding: 15px 10px;
                width: 100%;
            }
            
            .header h1 {
                font-size: 2rem;
                word-break: break-word;
            }
            
            .header .subtitle {
                font-size: 1rem;
            }
            
            .content {
                padding: 10px;
                width: 100%;
                max-width: 100%;
            }
            
            .nav-tabs {
                width: 100%;
                overflow-x: hidden;
            }
            
            .nav-tabs ul {
                display: flex;
                width: 100%;
                margin: 0;
                padding: 0;
            }
            
            .nav-tabs li {
                flex: 1;
                margin: 0;
            }
            
            .nav-tabs a {
                text-align: center;
                border-radius: 0;
                padding: 12px 8px;
                font-size: 0.9rem;
                white-space: nowrap;
            }
            
            .filters-panel {
                padding: 15px 10px;
                margin-bottom: 15px;
                width: 100%;
                max-width: 100%;
            }
            
            .filters-content,
            .filters-content-productos {
                display: flex;
                flex-direction: column;
                gap: 12px;
                width: 100%;
            }
            
            .search-section,
            .filter-dropdown {
                width: 100%;
                min-width: auto;
            }
            
            .search-input,
            .dropdown-select {
                width: 100%;
                max-width: 100%;
                box-sizing: border-box;
            }
            
            .filter-stats {
                flex-direction: column;
                align-items: stretch;
                gap: 10px;
                padding: 10px;
            }
            
            .stats-info {
                flex-wrap: wrap;
                justify-content: center;
                gap: 10px;
            }
            
            .active-filters {
                justify-content: center;
                flex-wrap: wrap;
            }
            
            .categorias-grid {
                grid-template-columns: 1fr;
                gap: 15px;
                width: 100%;
            }
            
            .productos-grid {
                grid-template-columns: 1fr;
                gap: 15px;
                width: 100%;
            }
            
            .categoria-card,
            .producto-card {
                width: 100%;
                max-width: 100%;
                box-sizing: border-box;
            }
            
            .breadcrumb {
                padding: 10px;
                font-size: 0.9rem;
                flex-wrap: wrap;
            }
            
            .modal {
                padding: 5px;
                width: 100vw;
                height: 100vh;
            }
            
            .modal-content {
                width: 100%;
                max-width: calc(100vw - 10px);
                max-height: calc(100vh - 10px);
                margin: 0;
            }
            
            .modal-image,
            .modal-placeholder {
                float: none;
                margin: 0 auto 15px;
                display: block;
                max-width: 100%;
                width: 100%;
                height: 200px;
            }
            
            .modal-body {
                padding: 15px;
            }
        }
        
        @media (max-width: 480px) {
            .header {
                padding: 12px 8px;
            }
            
            .header h1 {
                font-size: 1.6rem;
                line-height: 1.2;
            }
            
            .header .subtitle {
                font-size: 0.9rem;
            }
            
            .content {
                padding: 8px;
            }
            
            .nav-tabs a {
                padding: 10px 6px;
                font-size: 0.8rem;
            }
            
            .filters-panel {
                padding: 12px 8px;
                border-radius: 8px;
            }
            
            .filters-title {
                font-size: 1.1rem;
            }
            
            .search-input,
            .dropdown-select {
                padding: 10px 35px 10px 12px;
                font-size: 0.9rem;
            }
            
            .btn {
                padding: 10px 16px;
                font-size: 0.9rem;
            }
            
            .categoria-card-header {
                padding: 15px;
            }
            
            .categoria-nombre {
                font-size: 1.2rem;
            }
            
            .categoria-descripcion {
                font-size: 0.85rem;
            }
            
            .producto-card-imagen {
                height: 180px;
            }
            
            .producto-card-body {
                padding: 12px;
            }
            
            .producto-card-title {
                font-size: 1.1rem;
            }
            
            .producto-card-descripcion {
                font-size: 0.85rem;
            }
            
            .producto-card-precio {
                font-size: 1.3rem;
            }
            
            .modal-content {
                border-radius: 15px;
            }
            
            .modal-header {
                padding: 15px;
                font-size: 1.1rem;
            }
            
            .modal-body {
                padding: 12px;
            }
        }
        
        @media (max-width: 360px) {
            .header h1 {
                font-size: 1.4rem;
            }
            
            .nav-tabs a {
                padding: 8px 4px;
                font-size: 0.75rem;
            }
            
            .nav-tabs a i {
                display: none;
            }
            
            .content {
                padding: 6px;
            }
            
            .filters-panel {
                padding: 10px 6px;
            }
            
            .categoria-card-header,
            .producto-card-body {
                padding: 10px;
            }
            
            .producto-card-imagen {
                height: 160px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🍦 Heladería Artesanal</h1>
            <div class="subtitle">Sabores únicos, momentos inolvidables</div>
        </div>
        
        <nav class="nav-tabs">
            <ul>
                <li><a href="#" id="tab-categorias" class="active" onclick="cambiarVista('categorias')">
                    <i class="bi bi-grid-3x3-gap"></i> Categorías
                </a></li>
                <li><a href="#" id="tab-productos" onclick="cambiarVista('productos')">
                    <i class="bi bi-box-seam"></i> Todos los productos
                </a></li>
                <li><a href="#" id="tab-menu" onclick="cambiarVista('menu')">
                    <i class="bi bi-file-image"></i> Menú/Carta
                </a></li>
            </ul>
        </nav>
        
        <div class="content">
            <!-- Vista Categorías -->
            <div id="vista-categorias">
                <!-- Panel de filtros para categorías -->
                <div class="filters-panel">
                    <div class="filters-header">
                        <div class="filters-title">
                            <i class="bi bi-funnel"></i>
                            Explorar Categorías
                        </div>
                        <button class="filters-toggle" onclick="toggleAdvancedFilters('categoria')" id="categoria-toggle">
                            <i class="bi bi-sliders"></i> Filtros
                        </button>
                    </div>
                    <div class="filters-content">
                        <div class="search-section">
                            <input type="text" id="buscar-categoria" class="search-input" 
                                   placeholder="Buscar por nombre o descripción..." 
                                   oninput="filtrarCategorias()">
                            <i class="bi bi-search search-icon"></i>
                        </div>
                        <div class="filter-actions">
                            <button class="btn btn-secondary" onclick="limpiarFiltros('categoria')" id="clear-categoria-btn" style="display:none">
                                <i class="bi bi-x-circle"></i> Limpiar
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Estadísticas de categorías -->
                <div class="filter-stats" id="categoria-stats">
                    <div class="stats-info">
                        <div class="stat-item">
                            <i class="bi bi-grid-3x3-gap"></i>
                            <span id="total-categorias">0</span> categorías
                        </div>
                        <div class="stat-item">
                            <i class="bi bi-eye"></i>
                            <span id="categorias-mostradas">0</span> mostradas
                        </div>
                    </div>
                    <div class="active-filters" id="categoria-active-filters"></div>
                </div>
                
                <div id="contenido-categorias">
                    <div class="loading">
                        <i class="bi bi-hourglass-split"></i>
                        Cargando categorías...
                    </div>
                </div>
            </div>

            <!-- Vista Productos -->
            <div id="vista-productos" style="display:none">
                <!-- Breadcrumb -->
                <div class="breadcrumb" id="breadcrumb" style="display:none">
                    <a href="#" onclick="cambiarVista('categorias')">
                        <i class="bi bi-house"></i> Inicio
                    </a>
                    <span class="breadcrumb-separator">›</span>
                    <span id="categoria-actual">Todos los productos</span>
                </div>

                <!-- Panel de filtros para productos -->
                <div class="filters-panel">
                    <div class="filters-header">
                        <div class="filters-title">
                            <i class="bi bi-funnel"></i>
                            Filtrar Productos
                        </div>
                        <button class="filters-toggle" onclick="toggleAdvancedFilters('producto')" id="producto-toggle">
                            <i class="bi bi-sliders"></i> Filtros
                        </button>
                    </div>
                    <div class="filters-content-productos">
                        <div class="search-section">
                            <input type="text" id="buscar-producto" class="search-input" 
                                   placeholder="Buscar productos..." 
                                   oninput="filtrarProductos()">
                            <i class="bi bi-search search-icon"></i>
                        </div>
                        <div class="filter-dropdown">
                            <select id="filtro-categoria-producto" class="dropdown-select" onchange="filtrarProductos()">
                                <option value="">Todas las categorías</option>
                            </select>
                            <i class="bi bi-chevron-down dropdown-icon"></i>
                        </div>
                        <div class="filter-actions">
                            <button class="btn btn-secondary" onclick="limpiarFiltros('producto')" id="clear-producto-btn" style="display:none">
                                <i class="bi bi-x-circle"></i> Limpiar
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Estadísticas de productos -->
                <div class="filter-stats" id="producto-stats">
                    <div class="stats-info">
                        <div class="stat-item">
                            <i class="bi bi-box-seam"></i>
                            <span id="total-productos">0</span> productos
                        </div>
                        <div class="stat-item">
                            <i class="bi bi-eye"></i>
                            <span id="productos-mostrados">0</span> mostrados
                        </div>
                        <div class="stat-item" id="precio-promedio" style="display:none">
                            <i class="bi bi-currency-dollar"></i>
                            Precio promedio: $<span id="precio-promedio-valor">0</span>
                        </div>
                    </div>
                    <div class="active-filters" id="producto-active-filters"></div>
                </div>
                
                <div id="contenido-productos">
                    <div class="loading">
                        <i class="bi bi-hourglass-split"></i>
                        Cargando productos...
                    </div>
                </div>
            </div>


            
        </div>
    </div>
    
    <!-- Modal -->
    <div id="modal" class="modal" style="display:none" onclick="cerrarModal(event)">
        <div class="modal-content" onclick="event.stopPropagation()">
            <div class="modal-header">
                <i class="bi bi-info-circle"></i> Detalles del producto
                <button class="modal-close" onclick="cerrarModal()">&times;</button>
            </div>
            <div class="modal-body" id="modal-body">
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script>
        // Configuración de Supabase
        const supabaseUrl = "https://kntorhiruncbnhvvyint.supabase.co";
        const supabaseKey = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImtudG9yaGlydW5jYm5odnZ5aW50Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI4MTY1NjYsImV4cCI6MjA2ODM5MjU2Nn0.PpHPi0p0e_pdTloQip0X6-_NKG7KhHw89t4Yyrvm5ow";
        
        // Inicializar Supabase
        const supabase = window.supabase.createClient(supabaseUrl, supabaseKey);
        
        // Variables globales
        let productos = [];
        let categorias = [];
        let vistaActual = 'categorias';
        let categoriaSeleccionada = null;
        let filtros = {
            categoria: {
                texto: '',
                activos: []
            },
            producto: {
                texto: '',
                categoria: '',
                activos: []
            }
        };
        
        // Emojis para categorías con más variedad
        const categoriasEmojis = {
            'helados': '🍦',
            'helado': '🍦',
            'postres': '🍰',
            'postre': '🍰',
            'bebidas': '🥤',
            'bebida': '🥤',
            'snacks': '🍪',
            'snack': '🍪',
            'especiales': '⭐',
            'especial': '⭐',
            'cremosos': '🍨',
            'cremoso': '🍨',
            'frios': '🧊',
            'frio': '🧊',
            'calientes': '☕',
            'caliente': '☕',
            'frutas': '🍓',
            'fruta': '🍓',
            'chocolate': '🍫',
            'vainilla': '🤍',
            'caramelo': '🍮',
            'cafe': '☕',
            'té': '🍵',
            'te': '🍵',
            'default': '🍨'
        };
        
        // Función para obtener emoji por nombre de categoría
        function obtenerEmojiCategoria(nombre) {
            const nombreLower = nombre.toLowerCase();
            // Buscar coincidencias exactas o parciales
            for (const [key, emoji] of Object.entries(categoriasEmojis)) {
                if (nombreLower.includes(key) || key.includes(nombreLower)) {
                    return emoji;
                }
            }
            return categoriasEmojis.default;
        }
        
        // Cargar datos con mejor manejo de errores - SIN FILTROS DE ACTIVO
        async function cargarDatos() {
            try {
                mostrarEstadoCarga();
                
                // Cargar productos sin filtro 'activo' y con categorías
                const { data: productosData, error: productosError } = await supabase
                    .from('productos')
                    .select(`
                        *,
                        categoria:categorias(id, nombre, descripcion)
                    `)
                    .order('nombre');
                
                if (productosError) throw productosError;
                
                // Cargar categorías sin filtro 'activo'
                const { data: categoriasData, error: categoriasError } = await supabase
                    .from('categorias')
                    .select('*')
                    .order('nombre');
                
                if (categoriasError) throw categoriasError;
                
                productos = productosData || [];
                categorias = categoriasData || [];
                
                // Contar productos por categoría y agregar estadísticas
                categorias.forEach(categoria => {
                    const productosCategoria = productos.filter(p => p.categoria_id === categoria.id);
                    categoria.cantidadProductos = productosCategoria.length;
                    categoria.precioPromedio = productosCategoria.length > 0 
                        ? (productosCategoria.reduce((sum, p) => sum + parseFloat(p.precio || 0), 0) / productosCategoria.length).toFixed(2)
                        : 0;
                });
                
                // Cargar categorías en el select de filtros
                cargarCategoriasSelect();
                
                // Mostrar datos
                mostrarDatos();
                actualizarEstadisticas();
                
            } catch (error) {
                console.error('Error al cargar datos:', error);
                mostrarError('Error al cargar los datos. Por favor, intenta de nuevo más tarde.');
            }
        }
        
        // Mostrar estado de carga
        function mostrarEstadoCarga() {
            const contenidoCategorias = document.getElementById('contenido-categorias');
            const contenidoProductos = document.getElementById('contenido-productos');
            
            if (contenidoCategorias) {
                contenidoCategorias.innerHTML = `
                    <div class="loading">
                        <i class="bi bi-hourglass-split"></i>
                        Cargando categorías...
                    </div>
                `;
            }
            
            if (contenidoProductos) {
                contenidoProductos.innerHTML = `
                    <div class="loading">
                        <i class="bi bi-hourglass-split"></i>
                        Cargando productos...
                    </div>
                `;
            }
        }
        
        // Cargar categorías en el select
        function cargarCategoriasSelect() {
            const select = document.getElementById('filtro-categoria-producto');
            if (!select) return;
            
            select.innerHTML = '<option value="">Todas las categorías</option>';
            
            categorias.forEach(categoria => {
                const option = document.createElement('option');
                option.value = categoria.id;
                option.textContent = `${obtenerEmojiCategoria(categoria.nombre)} ${categoria.nombre} (${categoria.cantidadProductos})`;
                select.appendChild(option);
            });
        }
        
        // Mostrar datos según la vista actual
        function mostrarDatos() {
            if (vistaActual === 'categorias') {
                mostrarCategorias();
            } else {
                mostrarProductos();
            }
        }
        
        // Mostrar categorías en formato de cards
        function mostrarCategorias() {
            let categoriasFiltradas = [...categorias];
            
            // Aplicar filtro de texto
            if (filtros.categoria.texto) {
                categoriasFiltradas = categoriasFiltradas.filter(cat => 
                    cat.nombre.toLowerCase().includes(filtros.categoria.texto.toLowerCase()) ||
                    (cat.descripcion && cat.descripcion.toLowerCase().includes(filtros.categoria.texto.toLowerCase()))
                );
            }
            
            const contenido = document.getElementById('contenido-categorias');
            if (!contenido) return;
            
            if (categoriasFiltradas.length === 0) {
                contenido.innerHTML = `
                    <div class="no-results">
                        <i class="bi bi-search"></i>
                        <h3>No se encontraron categorías</h3>
                        <p>Intenta con otros términos de búsqueda</p>
                    </div>
                `;
                return;
            }
            
            let html = '<div class="categorias-grid">';
            
            categoriasFiltradas.forEach(categoria => {
                const emoji = obtenerEmojiCategoria(categoria.nombre);
                html += `
                    <div class="categoria-card" onclick="verCategoria(${categoria.id}, '${categoria.nombre.replace(/'/g, "\\'")}')">
                        <div class="categoria-header">
                            <span class="categoria-icon">${emoji}</span>
                            <div class="categoria-nombre">${categoria.nombre}</div>
                            <div class="categoria-descripcion">${categoria.descripcion || 'Deliciosos productos de esta categoría'}</div>
                        </div>
                        <div class="categoria-footer">
                            <span class="categoria-count">${categoria.cantidadProductos} productos</span>
                            <i class="bi bi-arrow-right categoria-arrow"></i>
                        </div>
                    </div>
                `;
            });
            
            html += '</div>';
            contenido.innerHTML = html;
            
            // Actualizar estadísticas
            const categoriasElement = document.getElementById('categorias-mostradas');
            if (categoriasElement) {
                categoriasElement.textContent = categoriasFiltradas.length;
            }
        }
        
        // Mostrar productos en formato de cards
        function mostrarProductos() {
            let productosFiltrados = [...productos];
            
            // Aplicar filtro de categoría específica
            if (categoriaSeleccionada) {
                productosFiltrados = productosFiltrados.filter(p => p.categoria_id === categoriaSeleccionada);
            }
            
            // Aplicar filtro de categoría del dropdown
            if (filtros.producto.categoria) {
                productosFiltrados = productosFiltrados.filter(p => p.categoria_id == filtros.producto.categoria);
            }
            
            // Aplicar filtro de texto
            if (filtros.producto.texto) {
                productosFiltrados = productosFiltrados.filter(p =>
                    p.nombre.toLowerCase().includes(filtros.producto.texto.toLowerCase()) ||
                    (p.descripcion && p.descripcion.toLowerCase().includes(filtros.producto.texto.toLowerCase()))
                );
            }
            
            const contenido = document.getElementById('contenido-productos');
            if (!contenido) return;
            
            if (productosFiltrados.length === 0) {
                contenido.innerHTML = `
                    <div class="productos-grid">
                        <div class="no-results">
                            <i class="bi bi-search"></i>
                            <h3>No se encontraron productos</h3>
                            <p>Intenta ajustar los filtros o términos de búsqueda</p>
                        </div>
                    </div>
                `;
                return;
            }
            
            let html = '<div class="productos-grid">';
            
            productosFiltrados.forEach(producto => {
                const categoria = producto.categoria || { nombre: 'Sin categoría' };
                const descripcion = producto.descripcion || 'Delicioso producto de nuestra heladería';
                const precio = parseFloat(producto.precio || 0).toFixed(2);
                
                html += `
                    <div class="producto-card" onclick="mostrarDetalle(${producto.id})">
                        <div class="producto-card-imagen">
                            ${producto.imagen ? 
                                `<img src="${producto.imagen}" alt="${producto.nombre}" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                                 <div class="producto-card-placeholder" style="display:none">🍦</div>` :
                                `<div class="producto-card-placeholder">🍦</div>`
                            }
                            <div class="producto-badge">${obtenerEmojiCategoria(categoria.nombre)}</div>
                        </div>
                        <div class="producto-card-body">
                            <div class="producto-card-title">${producto.nombre}</div>
                            <div class="producto-card-descripcion">${descripcion}</div>
                            <div class="producto-card-footer">
                                <div class="producto-card-precio">${precio}</div>
                                <div class="producto-card-categoria">${categoria.nombre}</div>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            html += '</div>';
            contenido.innerHTML = html;
            
            // Actualizar estadísticas
            const productosElement = document.getElementById('productos-mostrados');
            if (productosElement) {
                productosElement.textContent = productosFiltrados.length;
            }
            
            // Calcular precio promedio
            if (productosFiltrados.length > 0) {
                const precioPromedio = (productosFiltrados.reduce((sum, p) => sum + parseFloat(p.precio || 0), 0) / productosFiltrados.length).toFixed(2);
                const precioElement = document.getElementById('precio-promedio-valor');
                const precioContainer = document.getElementById('precio-promedio');
                if (precioElement && precioContainer) {
                    precioElement.textContent = precioPromedio;
                    precioContainer.style.display = 'flex';
                }
            } else {
                const precioContainer = document.getElementById('precio-promedio');
                if (precioContainer) {
                    precioContainer.style.display = 'none';
                }
            }
        }
        
        // Cambiar vista
        function cambiarVista(vista) {
            vistaActual = vista;
            
            // Actualizar pestañas
            document.querySelectorAll('.nav-tabs a').forEach(a => a.classList.remove('active'));
            const tabElement = document.getElementById(`tab-${vista}`);
            if (tabElement) {
                tabElement.classList.add('active');
            }
            
            // Mostrar/ocultar contenido
            const vistaCategorias = document.getElementById('vista-categorias');
            const vistaProductos = document.getElementById('vista-productos');
            const breadcrumb = document.getElementById('breadcrumb');
            const categoriaActual = document.getElementById('categoria-actual');
            
            if (vista === 'categorias') {
                if (vistaCategorias) vistaCategorias.style.display = 'block';
                if (vistaProductos) vistaProductos.style.display = 'none';
                categoriaSeleccionada = null;
                filtros.producto.categoria = '';
                const selectCategoria = document.getElementById('filtro-categoria-producto');
                if (selectCategoria) selectCategoria.value = '';
            } else {
                if (vistaCategorias) vistaCategorias.style.display = 'none';
                if (vistaProductos) vistaProductos.style.display = 'block';
                if (breadcrumb) breadcrumb.style.display = 'flex';
                if (categoriaActual) categoriaActual.textContent = 'Todos los productos';
            }
            
            mostrarDatos();
            actualizarEstadisticas();
            actualizarFiltrosActivos();
        }
        
        // Ver productos de una categoría
        function verCategoria(id, nombre) {
            categoriaSeleccionada = id;
            vistaActual = 'productos';
            
            // Actualizar pestañas
            document.querySelectorAll('.nav-tabs a').forEach(a => a.classList.remove('active'));
            const tabProductos = document.getElementById('tab-productos');
            if (tabProductos) tabProductos.classList.add('active');
            
            // Mostrar vista productos
            const vistaCategorias = document.getElementById('vista-categorias');
            const vistaProductos = document.getElementById('vista-productos');
            const breadcrumb = document.getElementById('breadcrumb');
            const categoriaActual = document.getElementById('categoria-actual');
            
            if (vistaCategorias) vistaCategorias.style.display = 'none';
            if (vistaProductos) vistaProductos.style.display = 'block';
            if (breadcrumb) breadcrumb.style.display = 'flex';
            if (categoriaActual) categoriaActual.innerHTML = `${obtenerEmojiCategoria(nombre)} ${nombre}`;
            
            // Limpiar filtros de productos
            filtros.producto.texto = '';
            filtros.producto.categoria = '';
            const buscarProducto = document.getElementById('buscar-producto');
            const selectCategoria = document.getElementById('filtro-categoria-producto');
            if (buscarProducto) buscarProducto.value = '';
            if (selectCategoria) selectCategoria.value = '';
            
            mostrarProductos();
            actualizarEstadisticas();
            actualizarFiltrosActivos();
        }
        
        // Filtros mejorados
        function filtrarCategorias() {
            const buscarCategoria = document.getElementById('buscar-categoria');
            if (buscarCategoria) {
                filtros.categoria.texto = buscarCategoria.value.trim();
                mostrarCategorias();
                actualizarEstadisticas();
                actualizarFiltrosActivos();
                mostrarBotonLimpiar('categoria');
            }
        }
        
        function filtrarProductos() {
            const buscarProducto = document.getElementById('buscar-producto');
            const selectCategoria = document.getElementById('filtro-categoria-producto');
            
            if (buscarProducto) {
                filtros.producto.texto = buscarProducto.value.trim();
            }
            if (selectCategoria) {
                filtros.producto.categoria = selectCategoria.value;
            }
            
            mostrarProductos();
            actualizarEstadisticas();
            actualizarFiltrosActivos();
            mostrarBotonLimpiar('producto');
        }
        
        function mostrarBotonLimpiar(tipo) {
            const btnLimpiar = document.getElementById(`clear-${tipo}-btn`);
            if (!btnLimpiar) return;
            
            const tieneTexto = filtros[tipo].texto.length > 0;
            const tieneCategoria = tipo === 'producto' && filtros.producto.categoria.length > 0;
            const mostrar = tieneTexto || tieneCategoria || categoriaSeleccionada;
            
            btnLimpiar.style.display = mostrar ? 'inline-flex' : 'none';
        }
        
        function limpiarFiltros(tipo) {
            if (tipo === 'categoria') {
                filtros.categoria.texto = '';
                const buscarCategoria = document.getElementById('buscar-categoria');
                if (buscarCategoria) buscarCategoria.value = '';
                mostrarCategorias();
            } else {
                filtros.producto.texto = '';
                filtros.producto.categoria = '';
                categoriaSeleccionada = null;
                const buscarProducto = document.getElementById('buscar-producto');
                const selectCategoria = document.getElementById('filtro-categoria-producto');
                const categoriaActual = document.getElementById('categoria-actual');
                
                if (buscarProducto) buscarProducto.value = '';
                if (selectCategoria) selectCategoria.value = '';
                if (categoriaActual) categoriaActual.textContent = 'Todos los productos';
                mostrarProductos();
            }
            
            actualizarEstadisticas();
            actualizarFiltrosActivos();
            mostrarBotonLimpiar(tipo);
        }
        
        // Actualizar estadísticas
        function actualizarEstadisticas() {
            const totalCategorias = document.getElementById('total-categorias');
            const totalProductos = document.getElementById('total-productos');
            
            if (totalCategorias) totalCategorias.textContent = categorias.length;
            if (totalProductos) totalProductos.textContent = productos.length;
        }
        
        // Actualizar filtros activos
        function actualizarFiltrosActivos() {
            // Filtros activos para categorías
            const categoriaFilters = document.getElementById('categoria-active-filters');
            if (categoriaFilters) {
                categoriaFilters.innerHTML = '';
                
                if (filtros.categoria.texto) {
                    categoriaFilters.innerHTML += `
                        <div class="filter-tag">
                            <i class="bi bi-search"></i> "${filtros.categoria.texto}"
                            <span class="remove" onclick="limpiarFiltroTexto('categoria')">&times;</span>
                        </div>
                    `;
                }
            }
            
            // Filtros activos para productos
            const productoFilters = document.getElementById('producto-active-filters');
            if (productoFilters) {
                productoFilters.innerHTML = '';
                
                if (filtros.producto.texto) {
                    productoFilters.innerHTML += `
                        <div class="filter-tag">
                            <i class="bi bi-search"></i> "${filtros.producto.texto}"
                            <span class="remove" onclick="limpiarFiltroTexto('producto')">&times;</span>
                        </div>
                    `;
                }
                
                if (filtros.producto.categoria) {
                    const categoria = categorias.find(c => c.id == filtros.producto.categoria);
                    if (categoria) {
                        productoFilters.innerHTML += `
                            <div class="filter-tag">
                                <i class="bi bi-tag"></i> ${categoria.nombre}
                                <span class="remove" onclick="limpiarFiltroCategoria()">&times;</span>
                            </div>
                        `;
                    }
                }
                
                if (categoriaSeleccionada) {
                    const categoria = categorias.find(c => c.id === categoriaSeleccionada);
                    if (categoria) {
                        productoFilters.innerHTML += `
                            <div class="filter-tag">
                                <i class="bi bi-collection"></i> ${categoria.nombre}
                                <span class="remove" onclick="limpiarCategoriaSeleccionada()">&times;</span>
                            </div>
                        `;
                    }
                }
            }
        }
        
        // Limpiar filtros específicos
        function limpiarFiltroTexto(tipo) {
            filtros[tipo].texto = '';
            const buscarElement = document.getElementById(`buscar-${tipo}`);
            if (buscarElement) buscarElement.value = '';
            mostrarDatos();
            actualizarFiltrosActivos();
            mostrarBotonLimpiar(tipo);
        }
        
        function limpiarFiltroCategoria() {
            filtros.producto.categoria = '';
            const selectCategoria = document.getElementById('filtro-categoria-producto');
            if (selectCategoria) selectCategoria.value = '';
            mostrarProductos();
            actualizarFiltrosActivos();
            mostrarBotonLimpiar('producto');
        }
        
        function limpiarCategoriaSeleccionada() {
            categoriaSeleccionada = null;
            const categoriaActual = document.getElementById('categoria-actual');
            if (categoriaActual) categoriaActual.textContent = 'Todos los productos';
            mostrarProductos();
            actualizarFiltrosActivos();
            mostrarBotonLimpiar('producto');
        }
        
        // Toggle filtros avanzados (placeholder para futuras funcionalidades)
        function toggleAdvancedFilters(tipo) {
            // Aquí se pueden agregar filtros más avanzados como rango de precios, ordenamiento, etc.
            console.log(`Filtros avanzados para ${tipo} - funcionalidad futura`);
        }
        
        // Modal mejorado
        function mostrarDetalle(id) {
            const producto = productos.find(p => p.id === id);
            if (!producto) return;
            
            const categoria = producto.categoria || { nombre: 'Sin categoría' };
            const precio = parseFloat(producto.precio || 0).toFixed(2);
            
            const modalBody = document.getElementById('modal-body');
            if (!modalBody) return;
            
            modalBody.innerHTML = `
                ${producto.imagen ? 
                    `<img src="${producto.imagen}" alt="${producto.nombre}" class="modal-image" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                     <div class="modal-placeholder" style="display:none">🍦</div>` :
                    `<div class="modal-placeholder">🍦</div>`
                }
                <h2 style="color: #2c3e50; margin-bottom: 15px;">${producto.nombre}</h2>
                <div style="margin-bottom: 15px;">
                    <strong style="color: #6c757d;">Precio:</strong> 
                    <span style="color: #28a745; font-weight: bold; font-size: 1.5rem;">${precio}</span>
                </div>
                <div style="margin-bottom: 15px;">
                    <strong style="color: #6c757d;">Categoría:</strong> 
                    <span style="background: #f8f9fa; padding: 4px 12px; border-radius: 15px; color: #6c757d; border: 1px solid #e9ecef;">
                        ${obtenerEmojiCategoria(categoria.nombre)} ${categoria.nombre}
                    </span>
                </div>
                ${producto.descripcion ? `
                    <div style="margin-top: 20px;">
                        <strong style="color: #6c757d;">Descripción:</strong>
                        <p style="margin-top: 8px; line-height: 1.6; color: #495057;">${producto.descripcion}</p>
                    </div>
                ` : ''}
                <div style="clear: both; margin-top: 20px; padding-top: 20px; border-top: 2px solid #f8f9fa; text-align: center;">
                    <button class="btn btn-primary" onclick="cerrarModal()">
                        <i class="bi bi-check-circle"></i> Entendido
                    </button>
                </div>
            `;
            
            const modal = document.getElementById('modal');
            if (modal) modal.style.display = 'flex';
        }
        
        function cerrarModal(event) {
            const modal = document.getElementById('modal');
            if (!modal) return;
            
            if (!event || event.target === modal) {
                modal.style.display = 'none';
            }
        }
        
        function mostrarError(mensaje) {
            const contenido = vistaActual === 'categorias' ? 
                document.getElementById('contenido-categorias') : 
                document.getElementById('contenido-productos');
                
            if (!contenido) return;
            
            contenido.innerHTML = `
                <div class="error">
                    <i class="bi bi-exclamation-triangle" style="font-size: 2rem; margin-bottom: 10px; display: block;"></i>
                    <strong>¡Oops! Algo salió mal</strong><br>
                    ${mensaje}
                </div>
            `;
        }
        
        // Event listeners
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                cerrarModal();
            }
        });
        
        // Búsqueda en tiempo real con debounce
        let searchTimeout;
        function debounceSearch(callback, delay = 300) {
            clearTimeout(searchTimeout);
            searchTimeout = setTimeout(callback, delay);
        }
        
        // Agregar event listeners después de que el DOM esté cargado
        function agregarEventListeners() {
            const buscarCategoria = document.getElementById('buscar-categoria');
            const buscarProducto = document.getElementById('buscar-producto');
            
            if (buscarCategoria) {
                buscarCategoria.addEventListener('input', function() {
                    debounceSearch(filtrarCategorias);
                });
            }
            
            if (buscarProducto) {
                buscarProducto.addEventListener('input', function() {
                    debounceSearch(filtrarProductos);
                });
            }
        }
        
        // Inicializar aplicación
        window.addEventListener('load', function() {
            console.log('🚀 Iniciando Heladería Artesanal...');
            agregarEventListeners();
            cargarDatos();
            
            // Recargar datos cada 60 segundos
            setInterval(cargarDatos, 60000);
        });
        
        // PWA - Service Worker básico (opcional)
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                // Registro del service worker se puede agregar aquí si se desea funcionalidad offline
            });
        }
    </script>


<script>

</script>
</body>
</html>
